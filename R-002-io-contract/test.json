{
  "test_id": "R-002-io-contract",
  "protocol_version": "1.1",
  "category": "resolver",
  "description": "Tests that resolver I/O contracts are correctly recognized and saveAs fields are applied.",
  "spec_ref": [
    "ยง4.3 Resolver Input/Output Contracts",
    "ยง3.2 Step Parsing",
    "ยง2.3 Symbol Normalization"
  ],
  "fixtures": {
    "inputs": [
      {
        "workflow": "R-002-io-contract/workflow.ol",
        "values": {
          "userInput": "42"
        }
      }
    ]
  },
  "assertions": [
    {
      "id": "allowed_resolvers_listed",
      "type": "allowed_resolvers_listed",
      "expected": ["Calculator", "WeatherService"],
      "severity": "fatal",
      "description": "Parser must capture all allowed resolvers"
    },
    {
      "id": "ask_step_type",
      "type": "step_type",
      "stepIndex": 0,
      "expected": "ask",
      "severity": "fatal",
      "description": "Step 1 must be parsed as 'ask'"
    },
    {
      "id": "ask_step_saveas",
      "type": "step_saveas",
      "stepIndex": 0,
      "expected": "calcResult",
      "severity": "fatal",
      "description": "Step 1 saveAs must be 'calcResult'"
    },
    {
      "id": "use_step_type",
      "type": "step_type",
      "stepIndex": 1,
      "expected": "use",
      "severity": "fatal",
      "description": "Step 2 must be parsed as 'use'"
    },
    {
      "id": "use_step_saveas",
      "type": "step_saveas",
      "stepIndex": 1,
      "expected": "weatherInfo",
      "severity": "fatal",
      "description": "Step 2 saveAs must be 'weatherInfo'"
    },
    {
      "id": "workflow_return_values",
      "type": "workflow_return_values",
      "expected": ["calcResult", "weatherInfo"],
      "severity": "fatal",
      "description": "Return statement must list all saved outputs"
    },
    {
      "id": "no_parse_warnings",
      "type": "no_parse_warnings",
      "expected": 0,
      "severity": "warning",
      "description": "No warnings for valid I/O contracts"
    }
  ]
}