{
  "test_id": "R-003-failure-modes",
  "protocol_version": "1.1",
  "category": "resolver",
  "description": "Tests that resolver failure modes and retry policies are parsed and exposed.",
  "spec_ref": [
    "ยง4.4 Resolver Failure Modes",
    "ยง3.3 Step Parsing",
    "ยง2.3 Symbol Normalization"
  ],
  "fixtures": {
    "inputs": [
      {
        "workflow": "R-003-failure-modes/workflow.ol",
        "values": {
          "userInput": "someInput"
        }
      }
    ]
  },
  "assertions": [
    {
      "id": "allowed_resolvers_listed",
      "type": "allowed_resolvers_listed",
      "expected": ["ReliableResolver", "UnstableResolver"],
      "severity": "fatal",
      "description": "Allowed resolvers must be captured"
    },
    {
      "id": "step_0_saveas",
      "type": "step_saveas",
      "stepIndex": 0,
      "expected": "reliableResult",
      "severity": "fatal",
      "description": "Step 0 saveAs"
    },
    {
      "id": "step_1_saveas",
      "type": "step_saveas",
      "stepIndex": 1,
      "expected": "unstableResult",
      "severity": "fatal",
      "description": "Step 1 saveAs"
    },
    {
      "id": "workflow_name_present",
      "type": "workflow_name_present",
      "expected": "TestResolverFailureModes",
      "severity": "fatal",
      "description": "Workflow name parsed"
    },
    {
      "id": "workflow_return_values",
      "type": "workflow_return_values",
      "expected": ["reliableResult", "unstableResult"],
      "severity": "fatal",
      "description": "Return values listed"
    },
    {
      "id": "unstable_resolver_failure_policies",
      "type": "step_failure_policies",
      "stepIndex": 1,
      "expected": {
        "TIMEOUT": {
          "action": "retry",
          "count": 2
        },
        "NETWORK_ERROR": {
          "action": "fail",
          "count": 0
        }
      },
      "severity": "fatal",
      "description": "Failure modes and retry counts must be parsed"
    },
    {
      "id": "no_parse_warnings",
      "type": "no_parse_warnings",
      "expected": 0,
      "severity": "warning",
      "description": "No warnings for valid failure mode syntax"
    }
  ]
}